[allowlist]
description = "Allow encrypted secrets and known patterns"
regexes = [
  # SOPS encrypted values (we do not decrypt in CI)
  'ENC\[AES256_GCM,.+\]',
  # Ansible variable references
  '\{\{\s*.*_password\s*\}\}',
  '\{\{\s*.*_key\s*\}\}',
  '\{\{\s*.*_token\s*\}\}',
  '\{\{\s*.*_api_key\s*\}\}',
  # Placeholder values in configuration files
  'POSTGRES_PASSWORD:\s*"\{\{\s*postgres_password\s*\}\}"',
  'PICTRS__SERVER__API_KEY:\s*"\{\{\s*postgres_password\s*\}\}"'
]

paths = [
  # Allow SOPS managed variable files
  'deploy/.*/group_vars/.*/secrets.yml',
  'deploy/.*/host_vars/.*/secrets.yml',
  # Allow template files
  '.*\.j2$'
]
