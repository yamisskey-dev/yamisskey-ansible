---
# TrueNAS Scale „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó„ÉªÁÆ°ÁêÜ„Éó„É¨„Ç§„Éñ„ÉÉ„ÇØ
# Core Infrastructure + Apps deployment
- name: TrueNAS Scale Complete Setup
  hosts: truenas
  become: yes
  gather_facts: yes

  tasks:
    - name: Display TrueNAS Setup Plan
      debug:
        msg: |
          ==============================================
          TrueNAS Scale 25.04 Complete Setup
          ==============================================
          Target: {{ inventory_hostname }}
          Domain: {{ truenas_minio_domain | default('example.invalid') }}
          Pool: {{ truenas_pool_name }}
          ==============================================

    - name: Setup TrueNAS Core Infrastructure
      include_role:
        name: yamisskey.appliances.core
      tags: ['core', 'infrastructure']

    - name: Deploy TrueNAS Applications
      include_role:
        name: yamisskey.appliances.apps
      tags: ['apps', 'applications']

    - name: Display completion summary
      debug:
        msg: |
          ==============================================
          TrueNAS Scale Setup Complete
          ==============================================
          ‚úÖ Core Infrastructure: ZFS, Users, Snapshots
          ‚úÖ Applications: MinIO + Cloudflared Custom App
          ‚úÖ Cloudflare Tunnel: {{ truenas_minio_domain | default('example.invalid') }}
          ‚úÖ Management UI: {{ truenas_api_url | default('https://truenas.local') }}

          üîß Next Steps:
          1. Configure Cloudflare DNS: {{ truenas_minio_domain | default('example.invalid') }}
          2. Run migration: migrate-minio-truenas.yml
          3. Update application configs
          ==============================================
