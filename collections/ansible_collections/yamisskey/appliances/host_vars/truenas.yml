---
# TrueNAS Scale 25.04 (Docker Compose固定)
ansible_host: "truenas.local"  # 実際のTrueNAS ScaleのIPアドレスに変更
ansible_user: root
ansible_connection: ssh

# シンプル化: TrueNAS = Docker Compose確定
minio_platform: "truenas"  # シンプルな識別子
minio_secrets_file: '/tmp/minio-secrets.yml'

# TrueNAS Scale 25.04 設定 (Cloudflare Tunnel統合)
truenas_minio_domain: "drive.yami.ski"
truenas_minio_app_name: "minio-cloudflared"
truenas_minio_version: "RELEASE.2025-01-01T00-00-00Z"
truenas_cloudflared_version: "latest"

# API設定 (Custom App管理用)
truenas_api_url: "https://{{ ansible_host }}"
truenas_api_key: "{{ truenas_api_token }}"  # Ansible Vault必須

# Cloudflare Tunnel設定 (Ansible Vault必須)
truenas_tunnel_id: "{{ cloudflare_tunnel_id }}"  # Vault: cloudflare tunnel token
truenas_tunnel_token: "{{ cloudflare_tunnel_token }}"  # Vault: Tunnel token
truenas_tunnel_credentials: "{{ cloudflare_tunnel_credentials }}"  # Vault: credentials.json

# MinIO Secrets (Ansible Vault必須)
truenas_minio_root_user: "{{ minio_root_user }}"  # Vault: MinIO root user
truenas_minio_root_password: "{{ minio_root_password }}"  # Vault: MinIO root password
truenas_minio_kms_key: "{{ minio_kms_secret_key }}"  # Vault: KMS encryption key

# Backup設定
truenas_backup_path: "/mnt/{{ truenas_pool_name }}/backups"
truenas_backup_config: true

# 移行設定 (Cloudflare Tunnel対応)
target_minio_alias: "truenas-tunnel" 
target_minio_endpoint: "https://{{ truenas_minio_domain }}"

# ストレージ設定 (ZFS Dataset)
truenas_pool_name: "tank"  # 実際のプール名に変更
truenas_minio_data_path: "/mnt/{{ truenas_pool_name }}/minio"
truenas_cloudflared_config_path: "/mnt/{{ truenas_pool_name }}/cloudflared"
truenas_apps_config_path: "/mnt/{{ truenas_pool_name }}/apps-config"

# Custom App設定
truenas_datasets:
  - name: "minio"   # already created via WebUI
    owner: "root"
    group: "root"
    mode: "0755"
  - name: "cloudflared"
    owner: "root"
    group: "root"
    mode: "0755"
  - name: "apps-config"
    owner: "root"
    group: "root"
    mode: "0755"

# リソース制限
truenas_minio_memory_limit: "4G"
truenas_minio_cpu_limit: "2.0"
truenas_minio_memory_reservation: "1G"
