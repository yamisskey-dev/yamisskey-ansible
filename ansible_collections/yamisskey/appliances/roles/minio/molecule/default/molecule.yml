---
dependency:
  name: galaxy
driver:
  name: docker
platforms:
  - name: truenas-test
    image: geerlingguy/docker-ubuntu2204-ansible:latest
    pre_build_image: true
    cgroupns_mode: host
    privileged: true
    security_opts:
      - seccomp=unconfined
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:rw
      - /var/run/docker.sock:/var/run/docker.sock
    tmpfs:
      - /run
      - /run/lock
      - /tmp
    command: /lib/systemd/systemd
    environment:
      container: docker
provisioner:
  name: ansible
  playbooks:
    prepare: prepare.yml
  config_options:
    defaults:
      callbacks_enabled: timer,profile_tasks
  inventory:
    group_vars:
      all:
        ansible_python_interpreter: /usr/bin/python3
    host_vars:
      truenas-test:
        truenas_pool_name: tank
        truenas_minio_domain: minio.example.com
        truenas_minio_app_name: minio-test
        truenas_minio_root_user: testuser
        truenas_minio_root_password: testpassword
        truenas_tunnel_token: test-token
        truenas_skip_health_check: true
        truenas_manage_custom_compose: false
verifier:
  name: ansible
