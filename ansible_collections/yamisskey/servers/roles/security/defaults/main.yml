---
# Security role default variables

# Package management
security_packages:
  - rsyslog
  - logrotate
  - ufw
  - lynis
  - clamav
  - clamav-daemon
  - dnscrypt-proxy

# UFW firewall configuration
security_ufw_enable: true
security_ufw_default_incoming: deny
security_ufw_default_outgoing: allow
security_ufw_logging: "off"

# SSH configuration
security_ssh_ports:
  - 22
  - 2222

security_ssh_settings:
  - 'AuthorizedKeysFile .ssh/authorized_keys'
  - 'RSAAuthentication yes'
  - 'PubkeyAuthentication yes'
  - 'AllowTcpForwarding yes'
  - 'ClientAliveCountMax 3'
  - 'Compression no'
  - 'LogLevel INFO'
  - 'MaxAuthTries 10'
  - 'MaxSessions 10'
  - 'TCPKeepAlive yes'
  - 'X11Forwarding no'
  - 'AllowAgentForwarding yes'

# ClamAV configuration
security_clamav_scan_schedule:
  minute: '0'
  hour: '19'  # UTC 19:00 = JST 04:00
  job: "/usr/bin/timeout 1h45m /usr/bin/nice -n 19 /usr/bin/clamdscan -m --fdpass --config-file=/etc/clamav/clamd.conf -l /var/log/clamav/clamav-$(date +\\%Y\\%m\\%d).log /"

# DNS over HTTPS configuration
security_dnscrypt_proxy_listen_address: "127.0.0.1:5300"
security_dnscrypt_proxy_servers:
  - "cloudflare"
  - "cloudflare-ipv6"
  - "quad9-dnscrypt-ip4-nofilter-pri"

# Docker DNS settings
security_docker_dns_servers:
  - "127.0.0.1"
  - "1.1.1.1"

# Service restart settings
security_restart_services_on_change: true

# Service management toggles
security_manage_clamav: true

# systemd-resolved configuration
security_systemd_resolved_dns: "127.0.0.1"
security_systemd_resolved_fallback_dns: "1.1.1.1"
