---
dependency:
  name: galaxy
  options:
    requirements-file: ../../requirements.yml
driver:
  name: docker
platforms:
  - name: watch-test-instance
    image: nixos/nix:2.21.5
    pre_build_image: true
    cgroupns_mode: host    command: bash -c "if ! command -v /root/.nix-profile/bin/python3 >/dev/null 2>&1; then nix profile install --accept-flake-config --profile /root/.nix-profile nixpkgs#python312 >/dev/null 2>&1 || exit 1; fi; mkdir -p /tmp/.ansible-tmp && chmod 1777 /tmp/.ansible-tmp && chown root:root /tmp/.ansible-tmp && touch /tmp/.ansible-tmp/.ansible-test && while true; do sleep 30; done"
    networks:
      - name: molecule-test-network
provisioner:
  name: ansible
  playbooks:
    prepare: prepare.yml
  inventory:
    group_vars:
      all:
        cadvisor:
          enabled: false
  config_options:
    defaults:
      host_key_checking: false
      deprecation_warnings: false
verifier:
  name: ansible
