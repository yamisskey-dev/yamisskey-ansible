---
- name: Verify packages role
  hosts: all
  become: true
  gather_facts: true

  tasks:
    - name: Verify essential packages are installed
      ansible.builtin.package:
        name: "{{ item }}"
        state: present
      loop:
        - curl
        - wget
        - git
        - vim
        - nano
        - htop
        - jq
      register: package_check

    - name: Verify Python packages are installed
      ansible.builtin.pip:
        name: "{{ item }}"
        state: present
      loop:
        - ansible
        - ansible-lint
        - yamllint
      register: pip_check
      when: packages_install_methods.pip is defined

    - name: Verify Docker is available
      ansible.builtin.command: docker --version
      register: docker_check
      failed_when: false
      changed_when: false

    - name: Display verification results
      ansible.builtin.debug:
        msg: |
          âœ… Package Verification Complete:
          ğŸ“¦ Essential packages: {{ package_check.changed | ternary('Installed', 'Already installed') }}
          ğŸ Python packages: {{ pip_check.changed | default('Skipped') | ternary('Installed', 'Already installed') }}
          ğŸ³ Docker: {{ docker_check.rc == 0 | ternary('Available', 'Not available') }}
