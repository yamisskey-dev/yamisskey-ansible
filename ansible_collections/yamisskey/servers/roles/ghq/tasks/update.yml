---
- name: Update yamisskey-dev repositories
  command: ghq get -u {{ item }}
  loop: "{{ yamisskey_repositories }}"
  register: ghq_update_results
  failed_when: false
  changed_when: ghq_update_results.rc == 0

- name: Display update results
  debug:
    msg: |
      ğŸ”„ Repository Update Results:
      {% for result in ghq_update_results.results %}
      - {{ result.item }}: {{ 'âœ… Updated successfully' if result.rc == 0 else 'âŒ Update failed' }}
      {% if result.rc != 0 and result.stderr is defined %}
        Error: {{ result.stderr }}
      {% endif %}
      {% endfor %}

- name: List updated repositories
  command: ghq list
  register: ghq_list_result
  changed_when: false
  failed_when: false

- name: Display updated repositories
  debug:
    msg: |
      ğŸ“ Updated repositories in {{ ghq_root }}:
      {{ ghq_list_result.stdout_lines | join('\n') }}
  when: ghq_list_result.rc == 0
