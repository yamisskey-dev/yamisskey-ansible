---
- name: List all repositories
  command: ghq list
  register: ghq_list_result
  changed_when: false
  failed_when: false

- name: Display all repositories
  debug:
    msg: |
      ğŸ“ All repositories in {{ ghq_root }}:
      {{ ghq_list_result.stdout_lines | join('\n') }}
  when: ghq_list_result.rc == 0

- name: Count repositories
  set_fact:
    repository_count: "{{ ghq_list_result.stdout_lines | length }}"

- name: Display repository count
  debug:
    msg: "Total repositories: {{ repository_count }}"
  when: ghq_list_result.rc == 0
