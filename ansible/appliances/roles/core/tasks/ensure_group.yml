---
- name: Query group
  command:
    argv: [midclt, -j, call, group.query,
           "{{ [['group', '=', group.gid]] | to_json }}"]
  register: gq
  changed_when: false

- name: Create group
  command:
    argv:
      - midclt
      - -j
      - call
      - group.create
      - >-
        {{ {"name": group.name, "gid": group.gid} | to_json }}
  when: (gq.stdout | from_json | length) == 0
