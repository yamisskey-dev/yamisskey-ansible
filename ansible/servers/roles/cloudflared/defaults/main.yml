---
# Default Cloudflared configuration
cloudflared_app_name: "yaminio"
cloudflared_tunnel_name: "{{ ansible_hostname }}-{{ cloudflared_app_name }}"
cloudflared_hostname: "drive.yami.ski"
cloudflared_service_port: 8080
cloudflared_install_dir: "/usr/local/bin"
cloudflared_config_dir: "/home/taka/.cloudflared"
cloudflared_system_config_dir: "/etc/cloudflared"
cloudflared_user: "taka"
cloudflared_group: "taka"
cloudflared_config_file: "{{ cloudflared_config_dir }}/config.yml"

# Cloudflare API configuration (from vault)
# cloudflare_api_token: "{{ vault_cloudflare_api_token }}"
# cloudflare_zone_id: "{{ vault_cloudflare_zone_id }}"
# cloudflare_account_id: "{{ vault_cloudflare_account_id }}"

# Tunnel configuration
cloudflared_protocol: "http2"
cloudflared_retries: 5
cloudflared_timeout: "5s"
cloudflared_compression: true
cloudflared_no_tls_verify: false
cloudflared_max_backoff: "15s"
cloudflared_connection_strategy: "race"
cloudflared_metrics_port: "49312"

# DNS configuration
cloudflared_dns_upstreams:
  - "127.0.0.1:5353"

# Origin request configuration
cloudflared_origin_request:
  disableChunkedEncoding: true
  connectTimeout: "2s"
  keepAliveTimeout: "15s"
  http2Origin: true
  tcpKeepAlive: "15s"
  noHappyEyeballs: true

# Installation configuration
cloudflared_skip_install: true   # Default to true - use 'make install' as recommended
cloudflared_version: "latest"    # GitHub release version (only used if skip_install is false)

# Service configuration
cloudflared_service_enable: true
cloudflared_service_start: true