---
- name: Deploy Misskey proxy services
  hosts: linode-prox
  become: true
  vars:
    ansible_python_interpreter: /usr/bin/python3
    docker_compose_cmd: 'docker compose'

  roles:
    - common
    - misskey-proxy

  post_tasks:
    - name: Show deployment summary
      debug:
        msg:
          - "Proxy deployment completed successfully!"
          - "Services deployed:"
          - "  - Squid proxy on port {{ squid_port }}"
          - "  - Media proxy (media-proxy-rs) on port 12766"
          - "  - Nginx proxy on port 80"
          - "  - Summaly service via docker compose"
          - ""
          - "Check service status with:"
          - "  docker ps"
          - "  systemctl status squid"
